\documentclass[a4paper,12pt,fleqn]{scrartcl}
\usepackage[l2tabu,orthodox]{nag}% Old habits die hard. All the same, there are commands, classes and packages which are outdated and superseded. nag provides routines to warn the user about the use of those.

\usepackage[all,error]{onlyamsmath}% Error on deprecated math commands like $$ $$.
\usepackage[strict=true]{csquotes}

%\usepackage{color}

\usepackage{listings}
\lstset{frame=single,framerule=0pt,language={C},showstringspaces=false,numbers=left,columns=fullflexible}

% COMP2111-specific macros. See
% http://www.cse.unsw.edu.au/~cs2111/18s1/LaTeX/primer.html
\usepackage{2111defs2}
\usepackage[colorlinks=true]{hyperref}

\newcommand{\assn}[1]{{\color{red}\left\{#1\right\}}}
\newcommand{\remark}[1]{{\sffamily\color{blue}{#1}}}

% define some convenience macros specific to this task
\newcommand{\perm}{\mathsf{perm}}
%title variable
\title{Assignment 2}
\author{Ruofei HUANG(z5141448)\and
Anqi ZHU(z5141541)
}


\newcommand{\variant}[3]{(#1:#2\mapsto #3)}
\newcommand{\oldwhatever}[4]{\variant{#1}{#2}{\variant{#1[#2]}{#3}{#4}}}
\newcommand{\whatever}[4]{\variant{#1}{#2\mapsto #3}{#4}}
\newcommand{\ah}{\mathsf{a}}
\newcommand{\be}{\mathsf{b}}
\newcommand{\length}[1]{\left|#1\right|}
\newcommand{\noof}[2]{\left\|#1\right\|_{#2}}
\def\L{\mathcal{L}}
\begin{document}
\maketitle
\section{Task 1}
main function (sth here) \
\begin{gather*}
  \PROC \ EMIRP(\VALUE \ n:\nat, \RESULT \ r:\nat)\cdot\cdotp\\
  \nt{
    n,r:\left[\begin{array}[c]{l}
      n >0, \\
      \sum_{i = 1}^{r}emirp(i)= n \And \sum_{i = 1}^{r-1}emirp(i)= n-1
    \end{array}\right]
  }{(1)}
\end{gather*}
where (sth here)
\begin{gather*}
  emirpVal(i) =
  \begin{cases}
    1 & \text{if } isPrime(r) \And isPrime(reverse(r)) \And r \neq reverse(r)\\
    0 & \text{else }
  \end{cases}
\end{gather*}
\section{Task 2}
\begin{align*}
  % refine to emirp (r) = 1
  \lrefstep{(1)}
  {\textbf{c-frame}}
  {
    r:\left[\begin{array}[c]{l}
      n >0, \\
      \sum_{i = 1}^{r}emirp(i)= n \And \sum_{i = 1}^{r-1}emirp(i)= n-1
    \end{array}\right]
  }\\
  %
  \refstep{\textbf{i-loc}}
  {
    \nt{\VAR j : r,j:\left[\begin{array}[c]{l}
      n >0 , \\
      \sum_{i = 1}^{r}emirp(i)= n \And \sum_{i = 1}^{r-1}emirp(i)= n-1
    \end{array}\right]
    }{(2)}
  }\\
  %
\end{align*}
We contruct the loop to verify the prime
\begin{align*}
  \lrefstep{(2)}
  {\textbf{c-frame}}
  {
    \nt{\VAR j : r,j:\left[\begin{array}[c]{l}
      n >0 , \\
      Inv
    \end{array}\right]
    }{(3)};\\
    &\nt{\VAR j : r,j:\left[\begin{array}[c]{l}
      Inv, \\
      \sum_{i = 1}^{r}emirp(i)= n \And \sum_{i = 1}^{r-1}emirp(i)= n-1
    \end{array}\right]
    }{(4)};\\
  }\\
\end{align*}
where the loop invariant is defined by
\begin{align*}
  Inv =
  \left(\begin{array}
    n > 0  \\
    \sum_{i = 1}^{j}emirp(i)= n \And \sum_{i = 1}^{j-1}emirp(i)= n-1 \And
  \end{array}\right)
\end{align*}


\end{document}
